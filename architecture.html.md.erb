---
title: Architecture
owner: Platform Engineering (KSM Team)
---
<strong><%= modified_date %></strong>

<%= partial ("beta-notice") %>

This topic describes <%= vars.product_full %> components, architecture, and technical detail.

##<a id='overview'></a> Overview

<%= vars.platform %> is a collection of components running on a BOSH deployed
VM that communicates with both Kubernetes clusters and <%= vars.product_name %>.


The following diagram describes how <%= vars.product_short %> communicates with
<%= vars.platform %> and a Kubernetes cluster:

<a href="images/reference_architecture.jpg" target="_blank">
    <img src="images/reference_architecture.jpg" alt="<%= vars.product_short %> reference architecture">
</a>

<%# The above diagram should probably be simplified or split up. It is hard to follow and read since the text is small. We also should write more text below that explains or describes the diagram in more detail for clarity/accessibility reasons. %>

<%= vars.product_short %> has the the following components:

+ [KSM Daemon](#ksm-d)
+ [KSM Broker](#ksm-broker)
+ [SOME OTHER COMPONENT?]()

##<a id='ksm-d'></a> KSM Daemon

The KSM daemon (ksm-d) is the API that the KSM CLI communicates with.
When an operator saves a Helm chart,
the ksm-d component validates the chart and stores it in ChartMuseum.
If you provide a descriptor in your `ksm.yaml` file, the component stores the
the description as well.

For more information about Helm charts and the `ksm.yaml` file,
see [Using <%= vars.product_short %>](./using.html).

##<a id='ksm-broker'></a> KSM Broker

The KSM broker is an Open Service Broker that is installed by the <%= vars.product_short %> tile. Dedicated instances are provided through the KSM broker.

When a <%= vars.platform %> developer runs `cf create-service`, the following happens:
    
1. The Cloud Controller sends the request to the broker. 
1. The broker deploys the Helm chart needed for the service.
1. The broker creates a dedicated service instance of the service in the backing cluster.

 For more information about Open Service Broker,
 see [Open Service Broker](https://www.openservicebrokerapi.org/).

 For more
 information about the `cf create-service` command,
 see [Creating Service Instances](https://docs.cloudfoundry.org/devguide/services/managing-services.html#create)
 in the Cloud Foundry documentation.

##<a id='osbapi'></a> Detailed life-cycle
###<a id='provision'></a> Provision
When a service instance is provisioned, <%= vars.product_short %>
creates a namespace in the cluster. This namespace is named `kibosh-xxxx`, where `xxxx` is the
`instance_id` generated by <%= vars.product_name %>.

###<a id='provision'></a> Bind
###<a id='provision'></a> Update
###<a id='provision'></a> Unbind
###<a id='provision'></a> Deprovision
